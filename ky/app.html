<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>跨域测试</title>
</head>
<body>

    <p>
        <input id="btnTest" type="button" value="浏览器跨域单元测试" onclick="init();"/></p>

</body>
</html>
<script type="text/javascript">
    var FullUrl = window.location.protocol + "//" + window.location.host + "/ky/";
    
    function init(urlprex) {
        var state = 0,
            iframe = document.createElement('iframe'),
            loadfn = function() {
                if (state === 1) {
                    var data = iframe.contentWindow.name; // 读取数据
                    alert(data); //弹出'I was there!'
                } else if (state === 0) {
                    state = 1;
                    iframe.contentWindow.location = FullUrl + "proxy.html"; // 设置的代理文件
                }
            };
        iframe.src = FullUrl + 'othersite/check.html';

        if (iframe.attachEvent) {
            iframe.attachEvent('onload', loadfn);
        } else {
            iframe.onload = loadfn;
        }
        document.body.appendChild(iframe);
    }
</script>
<script type="text/javascript">
    function destory() {
        iframe.contentWindow.document.write('');
        iframe.contentWindow.close();
        document.body.removeChild(iframe);
    }
</script>