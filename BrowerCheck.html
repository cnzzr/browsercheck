<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>浏览器配置检测（主站点测试）</title>  

    <script src="Scripts/jquery-1.7.1.js" type="text/javascript"></script>
    <script src="config.js" type="text/javascript"></script>
    <script type="text/javascript">
        //常量
        var StatusNG = 0;
        var StatusUP = 1;
        var StatusOK = 2;
        
        //检测项目
        var IdxBrowser = 0; //浏览器
        var IdxJs = 1;  //JavaScript是否启用
        var IdxCookie = 2;
        var IdxPopup = 3;
        var IdxFlash = 4;   //COA附件上传
        var IdxJre = 5;
        var IdxZone = 6;
        var IdxAllowFullsize = 7;   //全屏
        var IdxDecidePopupByIE = 8;;
        var IdxSliverlight = 9; //附件上传
        var IdxOtherSystem = 10;    //其他域名的检测

        function getCookieStatus() {
            var status = StatusNG;
            var cookieStr = "wb_check=kcehc_bw";
            document.cookie = cookieStr;
            if (document.cookie.indexOf(cookieStr) > -1) {
                status = StatusOK;
                var date = new Date();
                date.setTime(date.getTime() - 1000);
                document.cookie = cookieStr + "; expires=" + date.toGMTString();
            }
            return status;
        }
        
        function getPopupStatus(winUrl) {
            var status = StatusNG;
            var str_feature = 'toolbar=no' + ',menubar=no' + ',scrollbars=no' + ',resizable=no' + ',status=no' + ',width=1' + ',height=1' + ',top=0' + ',left=0' + ',screenX=0' + ',screenY=0';
            var popup_win = window.open(winUrl, "wb_check", str_feature);
            if (popup_win) {
                status = StatusOK;
            }
            return status;
        }
        function getFlashStatus() {
            var MinVer = 7;
            var status = StatusNG;
            if (navigator.plugins && navigator.plugins.length && navigator.plugins.length > 0) {
                var flashObj = navigator.plugins["Shockwave Flash"];
                if (flashObj && flashObj.length && flashObj.length > 0) {
                    var flashMimeObj = flashObj["application/x-shockwave-flash"];
                    if (flashMimeObj) {
                        var tempStr = flashObj.description.split(" Flash ");
                        var verNo = parseFloat(tempStr[1]);
                        if (verNo >= MinVer) {
                            status = StatusOK;
                        } else {
                            status = StatusUP;
                        }
                    }
                }
            }
            if (status == StatusNG) {
                for (var i = MinVer; i > 0; i--) {
                    try {
                        var flashObj = new ActiveXObject("ShockwaveFlash.ShockwaveFlash." + i);
                        if (i == MinVer) {
                            status = StatusOK;
                        } else {
                            status = StatusUP;
                        }
                        break;
                    } catch (e) {
                        status = StatusNG;
                    }
                }
            }
            return status;
        }
        function getJreStatus() {
            var status = StatusNG;
            try {
                status = JREDetect.getStatus();
            } catch (e) {
                status = StatusNG;
            }
            return status;
        }
        //检查信任站点
        function getTrustWebsiteStatus() {
            var status = StatusNG;
            try {
                var WshShell = new ActiveXObject("WScript.Shell");
                status = StatusOK;
            }
            catch (e) {
                status = StatusNG;
            }
            return status;
        }
        //检查选项 "允许由脚本初始化的窗口，没有大小和位置限制"
        function getAllowFullSizeWindowStatus() {
            var status = StatusNG;
            try {
                var WshShell = new ActiveXObject("WScript.Shell");
                var userMaxWin = WshShell.RegRead("HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\2\\2102");
                var machineMaxWin = WshShell.RegRead("HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\2\\2102");
                if (userMaxWin == "0" || machineMaxWin == "0") {
                    status = StatusOK;
                }
            }
            catch (e) {
                status = StatusNG;
            }
            return status;
        }
        //检查IE7中 把弹出窗口设置为"由Internet Exporer决定如何开打弹出窗口"
        function getDecidePopupByIEStatus() {
            var status = StatusNG;
            var WshShell = null;
            try {
                WshShell = new ActiveXObject("WScript.Shell");
            } catch (e) {
                status = StatusNG;
                return status;
            }
            try {
                var userPopupUseNewWindow = WshShell.RegRead("HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\TabbedBrowsing\\PopupsUseNewWindow");
                //var machinePopupUseNewWindow=WshShell.RegRead("HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Internet Explorer\\TabbedBrowsing\\PopupsUseNewWindow");
                //alert(userPopupUseNewWindow+","+machinePopupUseNewWindow);
                if (userPopupUseNewWindow == "0") {
                    status = StatusOK;
                }
                else {
                    status = StatusNG;
                }
            }
            catch (e) {
                //alert(e.number);
                status = StatusUP; //不是IE7不需检验
            }
            return status;
        }
        function getUrlDomain() {
            var arydomain = new Array(".com.cn", ".net.cn", ".org.cn", ".gov.cn", ".com", ".cn", ".net", ".cc", ".org", ".info", ".biz", ".tv");
            var domain = document.domain;
            var tmpdomain = "";
            for (var i = 0; i < arydomain.length; i++) {
                tmpdomain = arydomain[i];
                if (domain.indexOf(tmpdomain) != -1) {
                    domain = domain.replace(tmpdomain, "");
                    domain = domain.substring(domain.lastIndexOf(".") + 1, domain.length);
                    domain = domain + tmpdomain;
                    break;
                }
            }
            return domain;
        }
    </script>
    
    
    <script type="text/javascript">
    //var Domains = new Array();//config.js
    </script>
    

    <script type="text/javascript">
        /**
        *区分各类浏览器
        *    IE8 使用兼容模式后在检测的时候就变成了IE7
        */
        var Sys = {};  //区分各类浏览器
        function InitialInfo() {
            var ua = navigator.userAgent.toLowerCase();
            var s;
            (s = ua.match(/msie ([\d.]+)/)) ? Sys.ie = s[1] :
                (s = ua.match(/trident 7.0/)) ? Sys.ie = 11.0 :
                    (s = ua.match(/firefox\/([\d.]+)/)) ? Sys.firefox = s[1] :
                        (s = ua.match(/chrome\/([\d.]+)/)) ? Sys.chrome = s[1] :
                            (s = ua.match(/opera.([\d.]+)/)) ? Sys.opera = s[1] :
                                (s = ua.match(/version\/([\d.]+).*safari/)) ? Sys.safari = s[1] : 0;

            //IE下的检查
            if (Sys.ie) {
                IeCheck();
            }
//            else if (Sys.chrome) {
//                ChromeCheck();
//            }
//            else if (Sys.safari) {
//                SafariCheck();
//            }
//            else if (Sys.firefox) {
//                FireFoxCheck();
//            }
            else {
                $("#browerInfo").hide();
                $("#browerSet").hide();
                alert("系统暂不支持您当前使用的浏览器！请选择安装系统推荐使用的浏览器");
            }
        }

        //Javascript脚本支持，该检测有点多余
        function JsCheck(brower, index) {
            
            var jsStatus = true;
            if (jsStatus) {
                $("#" + brower + "BrowerRet" + index).html("成功");
                $("#" + brower + "BrowerRet" + index).css("color", "#008000");
            }
            else {
                $("#" + brower + "BrowerRet" + index).html("失败");
                $("#" + brower + "BrowerRet" + index).css("color", "red");

                $("#" + brower + "BrowerSuggest" + index).html("点击设置");
                $("#" + brower + "BrowerSuggest" + index).attr("href", "#");
                $("#" + brower + "BrowerSuggest" + index).click(function() {
                    TipShow(this, brower + 'jsset', "允许Javascript");
                });
            }
        }

        //可信站点检测
        function TrustWebSiteCheck(brower, index) {
            if (getTrustWebsiteStatus() == 2) {
                $("#" + brower + "BrowerRet" + index).html("成功");
                $("#" + brower + "BrowerRet" + index).css("color", "#008000");
            }
            else {
                $("#" + brower + "BrowerRet" + index).html("失败");
                $("#" + brower + "BrowerRet" + index).css("color", "red");

                $("#" + brower + "BrowerSuggest" + index).html("点击设置");
                $("#" + brower + "BrowerSuggest" + index).attr("href", "#");
                $("#" + brower + "BrowerSuggest" + index).click(function() {
                    TipShow(this, brower + 'trustwebsiteset', "添加可信站点");
                });
            }
        }

        //允许由脚本初始化的窗口，没有大小和位置限制
        function AllowFullSizeWindowCheck(brower, index) {

            if (getAllowFullSizeWindowStatus() == 2) {
                $("#" + brower + "BrowerRet" + index).html("成功");
                $("#" + brower + "BrowerRet" + index).css("color", "#008000");
            }
            else {
                $("#" + brower + "BrowerRet" + index).html("失败");
                $("#" + brower + "BrowerRet" + index).css("color", "red");

                $("#" + brower + "BrowerSuggest" + index).html("点击设置");
                $("#" + brower + "BrowerSuggest" + index).attr("href", "#");
                $("#" + brower + "BrowerSuggest" + index).click(function() {
                    TipShow(this, brower + 'allowfullsizewin', "允许由脚本操作窗口");
                });
            }           
        }

        //由Internet Exporer决定如何开打弹出窗口
        function DecidePopupByIECheck(brower, index) {
            if (getDecidePopupByIEStatus() == 2) {
                $("#" + brower + "BrowerRet" + index).html("成功");
                $("#" + brower + "BrowerRet" + index).css("color", "#008000");
            }
            else {
                $("#" + brower + "BrowerRet" + index).html("失败");
                $("#" + brower + "BrowerRet" + index).css("color", "red");

                $("#" + brower + "BrowerSuggest" + index).html("点击设置");
                $("#" + brower + "BrowerSuggest" + index).attr("href", "#");
                $("#" + brower + "BrowerSuggest" + index).click(function() {
                    TipShow(this, brower + 'decidepopupbyieset', "设置弹框模式");
                });
            }
        }

        //Cookies检测
        function CookieCheck(brower, index) {
            if (getCookieStatus() == 2) {
                $("#" + brower + "BrowerRet" + index).html("成功");
                $("#" + brower + "BrowerRet" + index).css("color", "#008000");
            }
            else {
                $("#" + brower + "BrowerRet" + index).html("失败");
                $("#" + brower + "BrowerRet" + index).css("color", "red");

                $("#" + brower + "BrowerSuggest" + index).html("点击设置");
                $("#" + brower + "BrowerSuggest" + index).attr("href", "#");
                $("#" + brower + "BrowerSuggest" + index).click(function() {
                    TipShow(this, brower + 'cookieset', "设置弹框模式");
                });
            }
        }

        //弹框检测
        function PopupCheck(brower, index) {
            if (getPopupStatus("BrowerCheckClose.html") == 2) {
                $("#" + brower + "BrowerRet" + index).html("成功");
                $("#" + brower + "BrowerRet" + index).css("color", "#008000");
            }
            else {
                $("#" + brower + "BrowerRet" + index).html("失败");
                $("#" + brower + "BrowerRet" + index).css("color", "red");

                $("#" + brower + "BrowerSuggest" + index).html("点击设置");
                $("#" + brower + "BrowerSuggest" + index).attr("href", "#");
                $("#" + brower + "BrowerSuggest" + index).click(function() {
                    TipShow(this, brower + 'popupset', "禁用弹框阻止程序");
                });
            }
        }

        //Flash播放器
        function FlashCheck(brower, index) {
            if (getFlashStatus() == 2) {
                $("#" + brower + "BrowerRet" + index).html("成功");
                $("#" + brower + "BrowerRet" + index).css("color", "#008000");

                $("#" + brower + "BrowerSuggest" + index).html("点击下载最新Flash插件");
                $("#" + brower + "BrowerSuggest" + index).attr("target", "_blank");
                $("#" + brower + "BrowerSuggest" + index).attr("href", "http://get.adobe.com/cn/flashplayer/");
            }
            else {
                $("#" + brower + "BrowerRet" + index).html("失败");
                $("#" + brower + "BrowerRet" + index).css("color", "red");

                $("#" + brower + "BrowerSuggest" + index).html("点击下载最新Flash插件");
                $("#" + brower + "BrowerSuggest" + index).attr("target", "_blank");
                $("#" + brower + "BrowerSuggest" + index).attr("href", "http://get.adobe.com/cn/flashplayer/");
            }
        }

        //Sliverlight检测
        function SliverlightCheck(brower, index) {
            if (Silverlight.isInstalled()) { // true/false
                $("#" + brower + "BrowerRet" + index).html("成功");
                $("#" + brower + "BrowerRet" + index).css("color", "#008000");
            }
            else {
                $("#" + brower + "BrowerRet" + index).html("失败");
                $("#" + brower + "BrowerRet" + index).css("color", "red");

                $("#" + brower + "BrowerSuggest" + index).html("点击下载最新Sliverlight插件");
                $("#" + brower + "BrowerSuggest" + index).attr("target", "_blank");
                $("#" + brower + "BrowerSuggest" + index).attr("href", "http://www.microsoft.com/getsilverlight/Get-Started/Install/");
            }
        }

        //其他业务系统检测
        function OtherSystemCheck(brower, index) {
            var checkResult = false;
            var helpHtml = "";
            
            if (checkResult) { // true/false
                $("#" + brower + "BrowerRet" + index).html("成功");
                $("#" + brower + "BrowerRet" + index).css("color", "#008000");
            }
            else {
                $("#" + brower + "BrowerRet" + index).html("失败");
                $("#" + brower + "BrowerRet" + index).css("color", "red");

                $("#" + brower + "BrowerSuggest" + index).html("<br/>" + helpHtml);
            }
        }

        //IE下的检测
        function IeCheck() {
            alert("系统在检查可信任站点时要运行ActiveX控件,\n\r可能会弹出对话框是允许ActiveX控件与页面交互的确认对话框,\n\r请点击\"确定\"按钮,否则无法对浏览器进行检查.");

            $(".c6ui-brower-ie").show();
            //浏览器版本检测，如果低于IE 7.0 提示不支持，如果是IE 7.0 建议升级到IE 8.0 ，若果是IE 8.0则没有提示
            $("#ieBrowerInfo1").html("Microsoft Internet Explorer " + Sys.ie);
            if (Math.round(Sys.ie) < 7) {
                $("#ieBrowerRet1").css("color", "red");
                $("#ieBrowerRet1").html("失败");

                $("#ieBrowerSuggest1").html("您正在使用的浏览器不被支持建议升级到IE8");
                $("#ieBrowerSuggest1").attr("href", "http://windows.microsoft.com/zh-CN/internet-explorer/downloads/ie-8");
                $("#ieBrowerSuggest1").attr("target", "_blank");
            }
            else {
                $("#ieBrowerRet1").css("color", "#008000");
                $("#ieBrowerRet1").html("成功");
            }
            if (Math.round(Sys.ie) < 8) {
                $("#ieBrowerSuggest1_0").html("建议升级到IE8");
                
                $("#ieBrowerSuggest1_1").html("官方下载地址");                
                $("#ieBrowerSuggest1_1").attr("href", "http://windows.microsoft.com/zh-CN/internet-explorer/downloads/ie-8");
                $("#ieBrowerSuggest1_1").attr("target", "_blank");

                $("#ieBrowerSuggest1_2").html("本地下载(XP 32位)");
                $("#ieBrowerSuggest1_2").attr("href", "../Resource/Tools/IE8-WindowsXP-x86-CHS.rar");
                $("#ieBrowerSuggest1_2").attr("target", "_blank");
                
            }

            //Javascript脚本支持，该检测有点多余
            JsCheck("ie", "2");
            //可信站点检测
            TrustWebSiteCheck("ie", "3");
            //允许由脚本初始化的窗口，没有大小和位置限制
            AllowFullSizeWindowCheck("ie", "4");
            //由Internet Exporer决定如何开打弹出窗口
            DecidePopupByIECheck("ie", "5");
            //Cookies检测
            CookieCheck("ie", "6");
            //弹框检测
            PopupCheck("ie", "7");
            //Flash播放器
            FlashCheck("ie", "8");
            //Sliverlight银光
            SliverlightCheck("ie", "9");
            //其他业务系统配置要求
            OtherSystemCheck("ie", "10");
        }

        //Chrome下的检测
        function ChromeCheck() {
            $(".c6ui-brower-chrome").show();

            //版本检测
            $("#chromeBrowerInfo1").html("Google Chrome " + Sys.chrome);
            $("#chromeBrowerRet1").css("color", "#008000");
            $("#chromeBrowerRet1").html("成功");

            if (Math.round(Sys.chrome.split('.')[0]) < 11) {
                $("#chromeBrowerSuggest1").attr("href", "http://www.google.com/chrome");
                $("#chromeBrowerSuggest1").html("检测到有新版本，点击更新");
                $("#chromeBrowerSuggest1").attr("target", "_blank");
            }
            //Javascript检测
            JsCheck("chrome", "2");
            //Cookies检测
            CookieCheck("chrome", "3");
            //弹框检测
            PopupCheck("chrome", "4");
            //Flash插件检测
            FlashCheck("chrome", "5");
        }

        //Safari下的检测
        function SafariCheck() {
            $(".c6ui-brower-safari").show();

            //版本检测
            $("#safariBrowerInfo1").html("Apple Safari " + Sys.safari);
            $("#safariBrowerRet1").css("color", "#008000");
            $("#safariBrowerRet1").html("成功");

            if (Math.round(Sys.safari.split('.')[0]) < 5) {
                $("#safariBrowerSuggest1").attr("href", "http://www.apple.com.cn/safari/download/");
                $("#safariBrowerSuggest1").html("检测到有新版本，点击更新");
                $("#safariBrowerSuggest1").attr("target", "_blank");
            }
            //Javascript检测
            JsCheck("safari", "2");
            //Cookies检测
            CookieCheck("safari", "3");
            //弹框检测
            PopupCheck("safari", "4");
            //Flash插件检测
            FlashCheck("safari", "5");
        }

        function FireFoxCheck() {
            $(".c6ui-brower-firefox").show();

            //版本检测
            $("#firefoxBrowerInfo1").html("Mozilla Firefox " + Sys.firefox);
            $("#firefoxBrowerRet1").css("color", "#008000");
            $("#firefoxBrowerRet1").html("成功");

            if (Math.round(Sys.firefox.split('.')[0]) < 5) {
                $("#firefoxBrowerSuggest1").attr("href", "http://firefox.com.cn/download");
                $("#firefoxBrowerSuggest1").html("检测到有新版本，点击更新");
                $("#firefoxBrowerSuggest1").attr("target", "_blank");
            }
            //Javascript检测
            JsCheck("firefox", "2");
            //Cookies检测
            CookieCheck("firefox", "3");
            //弹框检测
            PopupCheck("firefox", "4");
            //Flash插件检测
            FlashCheck("firefox", "5");
        }


        function TipClose(obj) {
            $(obj).parent().parent().parent().hide();
        }
        function TipShow(obj, id, title) {
            var imgStr = "<div id=\"";
            imgStr += id;
            imgStr += "\" class=\"c6ui-portal-area\" style=\"width:764px; position:absolute;\"><div class=\"c6ui-portal-area-title\"><div onclick=\"TipClose(this)\" style=\"float:right; color:#003299; cursor:pointer;\">关闭</div> <div class=\"c6ui-f14\">";
            imgStr += title;
            imgStr += "</div></div><div class=\"c6ui-portal-area-content\" ><img id='setimg' src=\"CheckIE/";
            imgStr += id;
            imgStr += ".jpg\" /><span id='loadinginfo'></span></div></div>";

            $("#set").html(imgStr);
            var offset = $(obj).offset();
            $("#set").css({ "top": offset.top + "px", "left": offset.left + "px" });

            $("#" + id).css("width", 100 + "px");
            $("#loadinginfo").html("正在加载……");
            $("#setimg").load(function() {
                $("#loadinginfo").html("");
                $("#set").fadeIn(600);
                $("#" + id).css("width", $("#" + id).find("img")[0].offsetWidth + 14 + "px");
            });
        }
        function CommonSet(obj, id, title) {
            if (Sys.ie) {
                TipShow(obj, "ie" + id, title);
            }
            else if (Sys.chrome) {
                TipShow(obj, "chrome" + id, title);
            }
            else if (Sys.safari) {
                TipShow(obj, "safari" + id, title);
            }
            else if (Sys.firefox) {
                TipShow(obj, "firefox" + id, title);
            }
            else {

            }
        }
        
    </script>

    <style type="text/css">
        .c6ui-portal-area
        {
            border: solid #aacbee 1px;
            font-size: 14px;
            background-color: #FFFFFF;
            margin: 10px 4px;
            width: 100%;
        }
        .c6ui-portal-area .c6ui-portal-area-title
        {
            overflow: hidden;
            border-bottom: solid #aacbee 1px;
            height: 29px;
            line-height: 29px;
            padding: 0 8px;
            background-color: #f9fcff;
            background-image: -moz-linear-gradient(top, #f9fcff, #e8f1f9); /* FF3.6 */
            background-image: -ms-linear-gradient(top, #f9fcff, #e8f1f9); /* IE10 */
            background-image: -o-linear-gradient(top, #f9fcff, #e8f1f9); /* Opera 11.10+ */
            background-image: -webkit-gradient(linear, left top, left bottom, from(#f9fcff), to(#e8f1f9)); /* Saf4+, Chrome */
            background-image: -webkit-linear-gradient(top, #f9fcff, #e8f1f9); /* Chrome 10+, Saf5.1+ */
            background-image: linear-gradient(top, #f9fcff, #e8f1f9);
            filter: progid:DXImageTransform.Microsoft.gradient(startColorStr='#f9fcff', EndColorStr='#e8f1f9'); /* IE6–IE9 */
        }
        .c6ui-portal-area .c6ui-portal-area-content
        {
            padding: 6px;
            overflow: hidden;
        }
        .c6ui-brower-ie
        {
            display: none;
        }
        .c6ui-brower-safari
        {
            display: none;
        }
        .c6ui-brower-chrome
        {
            display: none;
        }
        .c6ui-brower-firefox
        {
            display:none;
        }
        .browerInfo
        {
        }
        .browerRet
        {
            margin-left: 20px;
            font-weight: bold;
        }
        .browerSuggest
        {
            margin-left: 20px;
        }
        a
        {
            color: #003299;
            font-weight: bold;
        }

        .c6ui-f14 {}
        .c6ui-f15 {font-size:18px;font-weight: bold;}
    </style>
</head>
<body onload="InitialInfo()">
    <div style="width: 100%;">
        <div id="set" style="display: none; position: absolute;">
        </div>
        <div class="c6ui-portal-area">
            <div class="c6ui-portal-area-title">
                <div class="c6ui-f15">浏览器配置需求</div>
            </div>
            <div class="c6ui-portal-area-content">
                <ul style="padding: 0px; margin: 0px; list-style: none;">
                    <li>为了可以正常使用当前系统，您的浏览器需要：</li>
                    <li style="height:10px;"></li>
                    <li>1、要求使用 Microsoft Internet Explorer 7.0 或以上版本，如果您使用<a target="_blank" href="http://www.google.com/chrome">Google Chrome</a>或<a target="_blank" href="http://firefox.com.cn/download/">Mozilla Firefox</a> 则大部分系统功能将无法使用。
                        <br/>&nbsp;&nbsp; 如果你使用 360安全浏览器、360极速浏览器、QQ浏览器或搜狗浏览器等其他浏览器请在访问中南院业务系统时切换到“<b>兼容模式</b>”。
    </li>                    
                    <li>2、<span style="color:#008000;">推荐使用Microsoft Internet Explorer 8.0</span>
                        <a href="http://windows.microsoft.com/zh-CN/internet-explorer/downloads/ie-8">微软官方下载</a>
                        <a href="http://mis.msdi.cn/portal/install/ie/IE8-WindowsXP-x86-CHS.exe">本地下载(适用于XP 32位)</a></li>
                    <li>3、允许Javascript</li>
                    <li>4、如果使用IE浏览器，则请将“mis.msdi.cn/zny.msdi.cn/pmis.msdi.cn”加入可信任站点，同时启用选项 "允许由脚本初始化的窗口，没有大小和位置限制"</li>
                    <li>5、IE7或者以上版本把弹出窗口选项设置为"由Internet Exporer决定如何开打弹出窗口"</li>
                    <li>6、允许 Cookies </li>
                    <li>7、允许弹出窗口</li>
                    <li>8、安装有 Macromedia Flash播放器 7.0 或以上版本</li>
                    <li>9、安装有 Microsoft Sliverlight 银光插件 4.0 或以上版本</li>
                </ul>
            </div>
        </div>
        <div id="browerInfo" class="c6ui-portal-area">
            <div class="c6ui-portal-area-title">
                <div class="c6ui-f15">浏览器配置自动检测报告</div>
            </div>
            <div class="c6ui-portal-area-content">
                <div class="c6ui-brower-ie">
                    <ul style="padding: 0px; margin: 0px; list-style: none;">
                        <li>我们正在检查您的浏览器以确定是否满足以上的要求。如果看到任何一项失败！请按照提示操作。 
                            <a href="#" onclick="TipShow(this,'ieadjust','注意IE的兼容模式')">(注：由于IE兼容模式的开启可能造成浏览器版本检测不正确)</a>
                        </li>
                        <li style="height:10px;"></li>
                        <li>1、浏览器：
                            <span id="ieBrowerInfo1" class="browerInfo"></span>
                            <span id="ieBrowerRet1" class="browerRet"></span>
                            <span id="ieBrowerSuggest1_0" class="browerRet"></span>
                            <a id="ieBrowerSuggest1_1" class="browerSuggest"></a>
                            <a id="ieBrowerSuggest1_2" class="browerSuggest"></a>
                            <a id="ieBrowerSuggest1_3" class="browerSuggest"></a>
                        </li>
                        <li>2、Javascript：<span id="ieBrowerInfo2" class="browerInfo"></span><span id="ieBrowerRet2"
                            class="browerRet"></span><a id="ieBrowerSuggest2" class="browerSuggest"></a></li>
                        <li>3、可信任站点：<span id="ieBrowerInfo3" class="browerInfo"></span><span id="ieBrowerRet3"
                            class="browerRet"></span><a id="ieBrowerSuggest3" class="browerSuggest"></a></li>
                        <li>4、允许由脚本初始化的窗口，没有大小和位置限制：<span id="ieBrowerInfo4" class="browerInfo"></span><span
                            id="ieBrowerRet4" class="browerRet"></span><a id="ieBrowerSuggest4" class="browerSuggest"></a></li>
                        <li>5、由Internet Exporer决定如何开打弹出窗口：<span id="ieBrowerInfo5" class="browerInfo"></span><span
                            id="ieBrowerRet5" class="browerRet"></span><a id="ieBrowerSuggest5" class="browerSuggest"></a></li>
                        <li>6、Cookies：<span id="ieBrowerInfo6" class="browerInfo"></span><span id="ieBrowerRet6"
                            class="browerRet"></span><a id="ieBrowerSuggest6" class="browerSuggest"></a></li>
                        <li>7、弹出窗口：<span id="ieBrowerInfo7" class="browerInfo"></span><span id="ieBrowerRet7"
                            class="browerRet"></span><a id="ieBrowerSuggest7" class="browerSuggest"></a></li>
                        <li>8、Flash播放器：<span id="ieBrowerInfo8" class="browerInfo"></span><span id="ieBrowerRet8"
                            class="browerRet"></span><a id="ieBrowerSuggest8" class="browerSuggest"></a></li>
                        
                        <li>9、Silverlight插件：<span id="ieBrowerInfo9" class="browerInfo"></span><span id="ieBrowerRet9"
                            class="browerRet"></span><a id="ieBrowerRet9" class="browerSuggest"></a></li>
                        <li>10、其他业务系统使用要求：<span id="ieBrowerInfo10" class="browerInfo"></span><span id="ieBrowerRet10"
                            class="browerRet"></span><a id="ieBrowerRet10" class="browerSuggest"></li>

                        <li style="height:10px;"></li>
                            <li><a href="http://mis.msdi.cn/sysmodule/FileSystem/Download.aspx?IsExec=true&Key=Goodway_BE-DownLoad&Id=FFL3MT1J_IETool.exe">下载常见问题修复工具(注：目前只在XP、Win7下进行全面的测试验证)</a></li>
                    </ul>
                </div>
                <div class="c6ui-brower-safari">
                    <ul style="padding: 0px; margin: 0px; list-style: none;">
                        <li>我们正在检查您的浏览器以确定是否满足以上的要求。如果看到任何一项失败！，请按照提示操作。 </li>
                        <li style="height:10px;"></li>
                        <li>1、浏览器：<span id="safariBrowerInfo1" class="browerInfo"></span><span id="safariBrowerRet1" class="browerRet"></span><a
                            id="safariBrowerSuggest1" class="browerSuggest"></a></li>
                        <li>2、Javascript：<span id="safariBrowerInfo2" class="browerInfo"></span><span id="safariBrowerRet2" class="browerRet"></span><a
                            id="safariBrowerSuggest2" class="browerSuggest"></a></li>
                        <li>3、Cookies：<span id="safariBrowerInfo3" class="browerInfo"></span><span id="safariBrowerRet3" class="browerRet"></span><a
                            id="safariBrowerSuggest3" class="browerSuggest"></a></li>
                        <li>4、弹出窗口：<span id="safariBrowerInfo4" class="browerInfo"></span><span id="safariBrowerRet4" class="browerRet"></span><a
                            id="safariBrowerSuggest4" class="browerSuggest"></a></li>
                        <li>5、Flash播放器：<span id="safariBrowerInfo5" class="browerInfo"></span><span id="safariBrowerRet5" class="browerRet"></span><a
                            id="safariBrowerSuggest5" class="browerSuggest"></a></li>
                    </ul>
                </div>
                <div class="c6ui-brower-chrome">
                <ul style="padding: 0px; margin: 0px; list-style: none;">
                        <li>我们正在检查您的浏览器以确定是否满足以上的要求。如果看到任何一项失败！，请按照提示操作。 </li>
                        <li style="height:10px;"></li>
                        <li>1、浏览器：
                            <span id="chromeBrowerInfo1" class="browerInfo"></span>
                            <span id="chromeBrowerRet1" class="browerRet"></span>
                            <a id="chromeBrowerSuggest1" class="browerSuggest"></a>
                        </li>
                        <li>2、Javascript：
                            <span id="chromeBrowerInfo2" class="browerInfo"></span>
                            <span id="chromeBrowerRet2" class="browerRet"></span>
                            <a id="chromeBrowerSuggest2" class="browerSuggest"></a>
                        </li>
                        <li>3、Cookies：
                            <span id="chromeBrowerInfo3" class="browerInfo"></span>
                            <span id="chromeBrowerRet3" class="browerRet"></span>
                            <a id="chromeBrowerSuggest3" class="browerSuggest"></a>
                        </li>
                        <li>4、弹出窗口：
                            <span id="chromeBrowerInfo4" class="browerInfo"></span>
                            <span id="chromeBrowerRet4" class="browerRet"></span>
                            <a id="chromeBrowerSuggest4" class="browerSuggest"></a>
                        </li>
                        <li>5、Flash播放器：
                            <span id="chromeBrowerInfo5" class="browerInfo"></span>
                            <span id="chromeBrowerRet5" class="browerRet"></span>
                            <a id="chromeBrowerSuggest5" class="browerSuggest"></a>
                        </li>
                  </ul>
                </div>
                <div class="c6ui-brower-firefox">
                    <ul style="padding: 0px; margin: 0px; list-style: none;">
                        <li>我们正在检查您的浏览器以确定是否满足以上的要求。如果看到任何一项失败！，请按照提示操作。 </li>
                        <li style="height:10px;"></li>
                        <li>1、浏览器：
                            <span id="firefoxBrowerInfo1" class="browerInfo"></span>
                            <span id="firefoxBrowerRet1" class="browerRet"></span>
                            <a id="fireBrowerSuggest1" class="browerSuggest"></a>
                        </li>
                        <li>2、Javascript：
                            <span id="firefoxBrowerInfo2" class="browerInfo"></span>
                            <span id="firefoxBrowerRet2" class="browerRet"></span>
                            <a id="fireBrowerSuggest2" class="browerSuggest"></a>
                        </li>
                        <li>3、Cookies：
                            <span id="firefoxBrowerInfo3" class="browerInfo"></span>
                            <span id="firefoxBrowerRet3" class="browerRet"></span>
                            <a id="fireBrowerSuggest3" class="browerSuggest"></a>
                        </li>
                        <li>4、弹出窗口：
                            <span id="firefoxBrowerInfo4" class="browerInfo"></span>
                            <span id="firefoxBrowerRet4" class="browerRet"></span>
                            <a id="fireBrowerSuggest4" class="browerSuggest"></a>
                        </li>
                        <li>5、Flash播放器：
                            <span id="firefoxBrowerInfo5" class="browerInfo"></span>
                            <span id="firefoxBrowerRet5" class="browerRet"></span>
                            <a id="fireBrowerSuggest5" class="browerSuggest"></a>
                        </li>
                    </ul>
                </div>                
            </div>
        </div>
        
        <div id="browerSet" class="c6ui-portal-area">
            <div class="c6ui-portal-area-title">
                <div class="c6ui-f14">
                    基本配置说明</div>
            </div>
            <div class="c6ui-portal-area-content">
                <ul style="padding: 0px; margin: 0px; list-style: none;">
                    <li style="float:left; margin-left:10px;"><a onclick="CommonSet(this,'jsset','允许Javascript')" href="#">允许Javascript</a></li>
                    <li style="float:left; margin-left:10px;"><a onclick="CommonSet(this,'jsset','允许Cookies')" href="#">允许Cookies</a></li>
                    <li style="float:left; margin-left:10px;"><a onclick="CommonSet(this,'jsset','允许弹出窗口')" href="#">允许弹出窗口</a></li>
                    <li style="float:left; margin-left:10px;"><a href="http://get.adobe.com/cn/flashplayer/" target="_blank">安装Macromedia Flash播放器</a></li>
                    <li style="float:left; margin-left:10px;"><a href="" target="_blank">安装 Sliverlight</a></li>
                </ul>
            </div>
        </div>
        <div id="browerOcx" class="c6ui-portal-area">
           <div class="c6ui-portal-area-title">
                <div class="c6ui-f14">
                    系统常用插件</div>
          </div>
            <div class="c6ui-portal-area-content">
                <ul style="padding: 0px; margin: 0px; list-style: none;">
                    <li style="float:left; margin-left:10px;"><a href="">电子签章安全软件</a></li>
                    <li style="float:left; margin-left:10px;"><a href="">旧MIS系统插件</a></li>                    
                    <li style="float:left; margin-left:10px;"><a href="" >OFFICE在线编辑工具</a></li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>
<script>
    if (!window.Silverlight) {
        window.Silverlight = {};
    }

    //////////////////////////////////////////////////////////////////
    // isInstalled, checks to see if the correct version is installed
    //////////////////////////////////////////////////////////////////
    Silverlight.isInstalled = function (version) {
        var isVersionSupported = false;
        var container = null;

        try {
            var control = null;

            try {
                control = new ActiveXObject('AgControl.AgControl');
                if (version == null) {
                    isVersionSupported = true;
                }
                else if (control.IsVersionSupported(version)) {
                    isVersionSupported = true;
                }
                control = null;
            }
            catch (e) {
                var plugin = navigator.plugins["Silverlight Plug-In"];
                if (plugin) {
                    if (version === null) {
                        isVersionSupported = true;
                    }
                    else {
                        var actualVer = plugin.description;
                        if (actualVer === "1.0.30226.2")
                            actualVer = "2.0.30226.2";
                        var actualVerArray = actualVer.split(".");
                        while (actualVerArray.length > 3) {
                            actualVerArray.pop();
                        }
                        while (actualVerArray.length < 4) {
                            actualVerArray.push(0);
                        }
                        var reqVerArray = version.split(".");
                        while (reqVerArray.length > 4) {
                            reqVerArray.pop();
                        }

                        var requiredVersionPart;
                        var actualVersionPart;
                        var index = 0;


                        do {
                            requiredVersionPart = parseInt(reqVerArray[index]);
                            actualVersionPart = parseInt(actualVerArray[index]);
                            index++;
                        }
                        while (index < reqVerArray.length && requiredVersionPart === actualVersionPart);

                        if (requiredVersionPart <= actualVersionPart && !isNaN(requiredVersionPart)) {
                            isVersionSupported = true;
                        }
                    }
                }
            }
        }
        catch (e) {
            isVersionSupported = false;
        }
        if (container) {
            document.body.removeChild(container);
        }

        return isVersionSupported;
    };
</script>